package dungeonSite;

import java.util.HashMap;
import java.util.Iterator;
import java.util.List;

import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.SessionFactory;

public class UserDao {
	SessionFactory sessionFactory = HibernateUtil.getSessionFactory();
	Session session = sessionFactory.openSession();
	public void deleteByName(Session session, String username) 
	{
		System.out.println("Attempting to delete: " + username);
		User u = (User) session.get(YipYip.class, username);
		session.beginTransaction();
		session.delete(u);
		session.getTransaction().commit();
	}	
	public void deleteByID(Session session, Long id) 
	{
		System.out.println("Attempting to delete: " + id);
		YipYip yip = (YipYip) session.get(YipYip.class, id);
		session.beginTransaction();
		session.delete(yip);
		session.getTransaction().commit();
	}
	public void update(Session session, User u) 
	{
		YipYip yip = (YipYip) session.get(YipYip.class, 3L);
		yip.setMessage("Appa took off");
		session.beginTransaction();
		session.saveOrUpdate(yip);
		session.getTransaction().commit();
	}
	public void create(Session session, User u) 
	{
		System.out.println("Creating new message...");
		YipYip yip = new YipYip("Appa Yip Yip!");
		session.beginTransaction();
		session.save(yip);
		session.getTransaction().commit();
	}
	
	public HashMap<Long,User> getAll(Session session) 
	{
		Query q = session.createQuery("FROM User");
        
		List<User> y = q.list();
		User temp;
		HashMap<Long,User> ret = null;
		System.out.println("Reading messages...");
		for (Iterator<User> iterator = y.iterator(); iterator.hasNext();) 
		{
			temp = iterator.next();
			ret.put(temp.getUserID(), temp);
		}
		return ret;
	}
}
